<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>🌀 Oraa Slayer - أفضل منصة لمشاهدة الأنمي</title>

  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  
  <style>
    :root {
      --primary-color: #8B7BFF;
      --secondary-color: #FF7BA9;
      --accent-color: #5FD8FF;
      --accent-color-2: #FFA87D;
      --bg-dark: #0F0F25;
      --bg-card: rgba(26, 26, 60, 0.7);
      --text-light: #F8F8FF;
      --border-color: rgba(139, 123, 255, 0.4);
      --sidebar-width: 300px;
      --gradient-primary: linear-gradient(135deg, #8B7BFF, #5FD8FF);
      --gradient-secondary: linear-gradient(135deg, #FF7BA9, #FFA87D);
      --gradient-dark: linear-gradient(135deg, #0F0F25, #1A1A3A);
      --success-color: #3DD8A9;
      --error-color: #FF7B95;
      --warning-color: #FFC14D;
      --glass-bg: rgba(255, 255, 255, 0.08);
      --glass-border: rgba(255, 255, 255, 0.12);
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      background: var(--bg-dark);
      font-family: 'Cairo', sans-serif;
      color: var(--text-light);
      direction: rtl;
      transition: all 0.3s ease;
      background-image: 
        radial-gradient(circle at 10% 20%, rgba(139, 123, 255, 0.1) 0%, transparent 25%),
        radial-gradient(circle at 90% 80%, rgba(255, 123, 169, 0.1) 0%, transparent 25%);
      min-height: 100vh;
      padding-bottom: 90px;
    }

    /* 🔹 الهيدر الزجاجي - محسن للجوال */
    .main-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: rgba(30, 30, 60, 0.7);
      backdrop-filter: blur(20px);
      padding: 15px 20px;
      border-bottom: 1px solid var(--glass-border);
      position: sticky;
      top: 0;
      z-index: 100;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
    }

    .logo {
      font-size: 1.4rem;
      font-weight: 800;
      background: var(--gradient-primary);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 10px;
      text-shadow: 0 2px 10px rgba(139, 123, 255, 0.3);
    }
    
    .header-left {
        display: flex;
        align-items: center;
        gap: 15px;
    }
    
    /* زر فتح الإعدادات - محسن للجوال */
    #settingsToggle {
        color: var(--text-light);
        font-size: 1.3rem;
        cursor: pointer;
        transition: all 0.3s ease;
        background: var(--glass-bg);
        width: 40px;
        height: 40px;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        border: 1px solid var(--glass-border);
        backdrop-filter: blur(10px);
    }
    
    #settingsToggle:hover {
        background: var(--gradient-primary);
        transform: rotate(90deg) scale(1.1);
        box-shadow: 0 0 20px rgba(139, 123, 255, 0.6);
        border-color: transparent;
    }

    /* 🔸 تحسين واقعية الأزرار: Active State */
    .user-info:active, 
    #settingsToggle:active,
    .anime-card:active {
        transform: translateY(0) scale(0.98);
        opacity: 0.9;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5); /* إحساس بالضغط */
        transition: all 0.1s ease;
    }
    /* نهاية تحسين واقعية الأزرار */

    /* 🔹 شريط الأخبار المتحرك - محسن للجوال */
    .news-ticker {
      background: linear-gradient(135deg, rgba(255, 123, 169, 0.9), rgba(255, 168, 125, 0.9));
      backdrop-filter: blur(10px);
      padding: 10px 0;
      overflow: hidden;
      position: relative;
      box-shadow: 0 4px 20px rgba(255, 123, 169, 0.4);
      border-bottom: 1px solid rgba(255, 255, 255, 0.2);
    }
    
    .ticker-content {
      display: inline-block;
      white-space: nowrap;
      animation: ticker 35s linear infinite;
      padding-right: 100%;
      font-weight: 700;
      font-size: 0.9rem;
    }
    
    .ticker-content span {
      margin-left: 30px;
      display: inline-block;
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
    }
    
    .ticker-content i {
      margin-left: 6px;
      color: var(--bg-dark);
    }
    
    @keyframes ticker {
      0% { transform: translateX(0); }
      100% { transform: translateX(100%); }
    }

    /* 🔹 قائمة المستخدم المنسدلة - محسنة للجوال */
    .user-info {
      position: relative;
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      transition: 0.3s;
      padding: 6px 12px;
      border-radius: 14px;
      background: var(--glass-bg);
      border: 1px solid var(--glass-border);
      backdrop-filter: blur(10px);
    }

    .user-info:hover {
      transform: scale(1.05);
      background: rgba(139, 123, 255, 0.15);
      border-color: rgba(139, 123, 255, 0.4);
    }

    .user-info img {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      border: 2px solid var(--accent-color);
      object-fit: cover;
      transition: all 0.3s ease;
      background-color: var(--bg-card);
    }

    .user-info:hover img {
      border-color: var(--secondary-color);
      box-shadow: 0 0 15px rgba(255, 123, 169, 0.6);
    }

    .verify-gold {
      color: #FFD700;
      font-size: 1.1rem;
      filter: drop-shadow(0 0 5px #FFD700);
    }
    
    .user-name {
      max-width: 80px; 
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      font-weight: 600;
      font-size: 0.9rem;
    }

    .user-menu {
      display: none;
      position: absolute;
      top: 55px; 
      right: 0;
      background: rgba(40, 40, 70, 0.9);
      backdrop-filter: blur(20px);
      border-radius: 16px;
      overflow: hidden;
      box-shadow: 0 15px 35px rgba(0, 0, 0, 0.4);
      z-index: 110;
      min-width: 200px;
      transform-origin: top right;
      animation: menuFadeIn 0.2s ease-out forwards;
      border: 1px solid var(--glass-border);
    }

    @keyframes menuFadeIn {
      from { opacity: 0; transform: scale(0.9) translateY(-10px); }
      to { opacity: 1; transform: scale(1) translateY(0); }
    }

    .user-menu a {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 14px 18px;
      color: var(--text-light);
      text-decoration: none;
      transition: all 0.2s;
      white-space: nowrap;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      font-size: 0.9rem;
    }

    .user-menu a:last-child {
      border-bottom: none;
    }

    .user-menu a:hover {
      background: rgba(139, 123, 255, 0.2);
      color: var(--primary-color);
      padding-right: 22px;
    }
    
    .user-menu a i {
        font-size: 1.1rem;
        width: 22px; 
        text-align: center;
    }

    /* 🔹 شريط البحث المدمج في الهيدر (التعديل الرئيسي) */
    .header-search {
        flex-grow: 1; 
        margin: 0 15px; 
        position: relative;
        display: none; /* إخفاء افتراضياً في الجوال الصغير */
    }

    .header-search input {
        width: 100%;
        padding: 8px 40px 8px 15px;
        border-radius: 12px;
        border: 1px solid var(--glass-border);
        outline: none;
        background: rgba(255, 255, 255, 0.1);
        color: var(--text-light);
        font-family: 'Cairo', sans-serif;
        transition: all 0.3s;
        font-size: 0.9rem;
        backdrop-filter: blur(8px);
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
    }

    .header-search input:focus {
        border-color: var(--accent-color);
        box-shadow: 0 0 0 2px rgba(95, 216, 255, 0.4);
        background: rgba(255, 255, 255, 0.15);
    }

    .header-search .search-icon {
        position: absolute;
        left: 15px;
        top: 50%;
        transform: translateY(-50%);
        color: var(--accent-color);
        opacity: 0.9;
        font-size: 1rem;
        pointer-events: none;
    }
    
    /* 🔹 قائمة الأنميات - محسنة للجوال */
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); 
      gap: 20px; 
      padding: 20px;
      max-width: 1300px;
      margin: 0 auto;
    }
    
    .anime-card { 
        background: var(--bg-card);
        border-radius: 18px;
        overflow: hidden;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        text-align: center;
        transition: all 0.4s ease;
        cursor: pointer;
        position: relative;
        border: 1px solid var(--glass-border);
        backdrop-filter: blur(10px);
    }
    
    .anime-card:hover {
        transform: translateY(-10px) scale(1.03);
        box-shadow: 0 20px 40px rgba(139, 123, 255, 0.4);
        border-color: rgba(139, 123, 255, 0.5);
    }
    
    .anime-card::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: var(--gradient-primary);
        transform: scaleX(0);
        transition: transform 0.4s ease;
    }
    
    .anime-card:hover::before {
        transform: scaleX(1);
    }
    
    .anime-card img {
        width: 100%;
        height: 200px; 
        object-fit: cover;
        display: block;
        transition: transform 0.6s ease;
        background-color: var(--bg-card);
        background-image: linear-gradient(45deg, #1A1A3A, #2a2a50);
    }
    
    .anime-card:hover img {
        transform: scale(1.08);
    }
    
    .anime-card p {
        padding: 14px 10px;
        margin: 0;
        font-size: 0.9rem;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        color: var(--text-light);
        font-weight: 700;
        background: rgba(0, 0, 0, 0.4);
        transition: all 0.3s ease;
    }
    
    .anime-card:hover p {
        background: rgba(139, 123, 255, 0.25);
        color: var(--primary-color);
    }
    
    .anime-year {
        position: absolute;
        top: 10px;
        left: 10px;
        background: var(--gradient-secondary);
        color: white;
        padding: 5px 10px;
        border-radius: 12px;
        font-size: 0.75rem;
        font-weight: bold;
        z-index: 2;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    }

    .anime-rating {
        position: absolute;
        top: 10px;
        right: 10px;
        background: rgba(0, 0, 0, 0.8);
        color: gold;
        padding: 5px 10px;
        border-radius: 12px;
        font-size: 0.75rem;
        font-weight: bold;
        z-index: 2;
        display: flex;
        align-items: center;
        gap: 4px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    }
    
    /* 🚨 القائمة الجانبية (Sidebar) - محسنة للجوال */
    .sidebar {
        height: 100%;
        width: 85%;
        max-width: 320px;
        position: fixed;
        z-index: 150;
        top: 0;
        left: calc(-1 * 85%);
        background: rgba(35, 35, 65, 0.95);
        backdrop-filter: blur(25px);
        overflow-x: hidden;
        transition: left 0.4s ease;
        padding-top: 70px;
        box-shadow: 8px 0 30px rgba(0, 0, 0, 0.4);
        border-right: 1px solid var(--glass-border);
    }

    .sidebar.open {
        left: 0;
    }
    
    .sidebar-header {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 18px 20px;
        background: rgba(50, 50, 80, 0.8);
        border-bottom: 1px solid var(--glass-border);
        backdrop-filter: blur(10px);
    }

    .sidebar-header h2 {
        margin: 0;
        font-size: 1.2rem;
        color: var(--primary-color);
        display: flex;
        align-items: center;
        gap: 8px;
    }
    
    .sidebar .close-btn {
        font-size: 1.4rem;
        color: var(--text-light);
        cursor: pointer;
        transition: all 0.2s;
        width: 36px;
        height: 36px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        background: var(--glass-bg);
    }
    
    .sidebar .close-btn:hover {
        background: rgba(255, 123, 169, 0.2);
        color: var(--secondary-color);
        transform: rotate(90deg);
    }

    .sidebar-section {
        padding: 18px 0;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .sidebar-section:last-child {
        border-bottom: none;
    }

    .sidebar-section-title {
        padding: 0 20px 12px;
        font-size: 1rem;
        color: var(--primary-color);
        font-weight: 700;
        display: flex;
        align-items: center;
        gap: 8px;
    }

    .sidebar-item {
        padding: 14px 20px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        cursor: pointer;
        transition: all 0.2s;
        color: var(--text-light);
        text-decoration: none;
        border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        font-size: 0.9rem;
    }
    
    .sidebar-item:last-child {
        border-bottom: none;
    }
    
    .sidebar-item:hover {
        background: rgba(139, 123, 255, 0.15);
        padding-right: 25px;
    }
    
    .sidebar-item span {
        display: flex;
        align-items: center;
        gap: 12px;
    }
    
    .sidebar-item i {
        color: var(--primary-color);
        width: 20px;
        text-align: center;
        font-size: 1.1rem;
    }

    .sidebar-item .item-description {
        font-size: 0.75rem;
        color: rgba(255, 255, 255, 0.6);
        margin-top: 4px;
        font-weight: normal;
    }
    
    /* تنسيق مفتاح التبديل (Toggle Switch) - محسن للجوال */
    .switch {
      position: relative;
      display: inline-block;
      width: 46px;
      height: 24px;
    }

    .switch input { 
      opacity: 0;
      width: 0;
      height: 0;
    }

    .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #666;
      transition: .4s;
      border-radius: 24px;
    }

    .slider:before {
      position: absolute;
      content: "";
      height: 18px;
      width: 18px;
      left: 3px;
      bottom: 3px;
      background-color: white;
      transition: .4s;
      border-radius: 50%;
    }

    input:checked + .slider {
      background: var(--gradient-primary);
    }

    input:checked + .slider:before {
      transform: translateX(22px);
    }

    /* 🔹 التذييل والأزرار السفلية - محسن للجوال */
    footer {
      display: flex;
      justify-content: space-around;
      padding: 12px 0;
      background: rgba(30, 30, 60, 0.95);
      backdrop-filter: blur(25px);
      border-top: 1px solid var(--glass-border);
      position: fixed;
      bottom: 0;
      width: 100%;
      z-index: 90;
      box-shadow: 0 -8px 30px rgba(0, 0, 0, 0.4);
    }

    .nav-item {
      flex-grow: 1; 
      text-align: center;
      padding: 10px 0; 
      transition: all 0.3s;
      position: relative;
      border-radius: 14px;
      margin: 0 6px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 5px;
      text-decoration: none;
    }

    .nav-item:hover {
      background: rgba(139, 123, 255, 0.2);
      transform: translateY(-4px);
    }

    .nav-item.active {
      background: rgba(139, 123, 255, 0.25);
    }
    
    /* تعزيز واقعية الأزرار */
    .nav-item:active {
        transform: translateY(0) scale(0.95);
        opacity: 0.95;
    }
    /* نهاية تعزيز واقعية الأزرار */

    .nav-icon {
      color: var(--text-light);
      font-size: 1.2rem;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      justify-content: center;
      width: 22px;
      height: 22px;
    }

    .nav-label {
      font-size: 0.7rem;
      color: var(--text-light);
      transition: all 0.3s;
      font-weight: 600;
    }

    .nav-item::after {
      content: "";
      position: absolute;
      bottom: 0;
      right: 50%;
      transform: translateX(50%);
      width: 0;
      height: 3px;
      background: var(--gradient-primary);
      border-radius: 3px 3px 0 0;
      transition: width 0.3s;
    }

    .nav-item.active::after,
    .nav-item:hover::after {
      width: 35px;
    }

    .nav-item.active .nav-icon,
    .nav-item:hover .nav-icon,
    .nav-item.active .nav-label,
    .nav-item:hover .nav-label {
      color: var(--primary-color);
      transform: scale(1.1);
      filter: drop-shadow(0 0 8px rgba(139, 123, 255, 0.5));
    }

    .nav-badge {
      position: absolute;
      top: 6px;
      right: 50%;
      transform: translateX(18px);
      background: var(--gradient-secondary);
      color: white;
      border-radius: 8px;
      padding: 2px 5px;
      font-size: 0.55rem;
      font-weight: bold;
      min-width: 14px;
      text-align: center;
    }

    .to-home-btn {
      position: fixed;
      bottom: 100px; /* تم تعديل الموقع للأعلى قليلاً */
      left: 20px; 
      background: var(--gradient-primary);
      border: none;
      color: white;
      padding: 12px 15px;
      border-radius: 50%;
      cursor: pointer;
      z-index: 95;
      box-shadow: 0 8px 25px rgba(139, 123, 255, 0.6);
      transition: all 0.3s;
      width: 50px;
      height: 50px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.2rem;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
    }
    
    .to-home-btn:hover {
        transform: scale(1.15) translateY(-5px);
        box-shadow: 0 12px 30px rgba(139, 123, 255, 0.8);
    }
    
    .to-home-btn:active { /* تعزيز الواقعية */
        transform: scale(1) translateY(0);
        box-shadow: 0 4px 15px rgba(139, 123, 255, 0.6);
    }
    
    /* 🔔 الإشعارات - محسنة للجوال */
    .toast {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: rgba(45, 45, 75, 0.95);
      backdrop-filter: blur(25px);
      color: #fff;
      padding: 15px 22px;
      border-radius: 14px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
      border-left: 4px solid var(--primary-color);
      opacity: 0;
      transform: translateX(100%);
      transition: all 0.3s ease;
      z-index: 1000;
      max-width: 320px;
      border: 1px solid var(--glass-border);
      font-size: 0.9rem;
    }
    
    .toast.show {
      opacity: 1;
      transform: translateX(0);
    }
    
    .toast.success {
      border-left-color: var(--success-color);
    }
    
    .toast.error {
      border-left-color: var(--error-color);
    }
    
    .toast.warning {
      border-left-color: var(--warning-color);
    }

    /* تأثيرات إضافية */
    .pulse {
      animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
      0% { box-shadow: 0 0 0 0 rgba(139, 123, 255, 0.7); }
      70% { box-shadow: 0 0 0 12px rgba(139, 123, 255, 0); }
      100% { box-shadow: 0 0 0 0 rgba(139, 123, 255, 0); }
    }

    /* 🔄 مؤشر التحميل */
    .loading {
      display: none;
      text-align: center;
      padding: 25px;
      color: var(--primary-color);
    }
    
    .loading-spinner {
      border: 4px solid rgba(139, 123, 255, 0.3);
      border-radius: 50%;
      border-top: 4px solid var(--primary-color);
      width: 45px;
      height: 45px;
      animation: spin 1s linear infinite;
      margin: 0 auto;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    /* تصميم متجاوب إضافي للجوال */
    @media (min-width: 600px) {
        .header-search {
            display: block; /* إظهار شريط البحث في الأجهزة اللوحية وما فوق */
            max-width: 350px;
        }
    }

    @media (max-width: 600px) {
        /* إخفاء شريط البحث المدمج في الجوالات الصغيرة للحفاظ على المساحة في الهيدر */
        .header-search {
            display: none;
        }
        
        /* إظهار شريط البحث المنفصل لضمان وجوده في الجوالات الصغيرة */
        .search-bar-standalone {
            display: block;
        }
        
        .to-home-btn {
            bottom: 75px;
        }
    }

    @media (max-width: 480px) {
      .grid {
        grid-template-columns: repeat(auto-fill, minmax(130px, 1fr));
        gap: 15px;
        padding: 15px;
      }
      
      .anime-card img {
        height: 170px;
      }
      
      .logo {
        font-size: 1.2rem;
      }
      
      .user-name {
        display: none;
      }
      
      .search-icon {
        left: 20px;
      }
      
      .to-home-btn {
        width: 45px;
        height: 45px;
        bottom: 75px;
        left: 15px;
        font-size: 1.1rem;
      }
      
      .main-header {
        padding: 12px 15px;
      }
      
      .nav-label {
        display: none;
      }
      
      .nav-item {
        padding: 12px 0;
      }
      
      .nav-icon {
        font-size: 1.1rem;
      }
      
      .ticker-content {
        font-size: 0.8rem;
      }
      
      .sidebar {
        width: 90%;
        left: calc(-1 * 90%);
      }
    }
    
    @media (max-width: 360px) {
      .grid {
        grid-template-columns: repeat(auto-fill, minmax(110px, 1fr));
        gap: 12px;
        padding: 12px;
      }
      
      .anime-card img {
        height: 150px;
      }
      
      .anime-card p {
        font-size: 0.85rem;
        padding: 12px 8px;
      }
      
      /* شريط البحث المنفصل في الجوالات الصغيرة جداً */
      .search-bar-standalone input {
        padding: 14px 45px 14px 15px;
        font-size: 0.95rem;
      }
    }
  </style>
</head>

<body>
  <header class="main-header">
    <div class="header-left">
        <i class="fa-solid fa-bars-staggered" id="settingsToggle" title="القائمة الرئيسية"></i>
        <div class="logo">Oraa Slayer </div>
    </div>
    
    <div class="header-search">
        <input type="text" id="searchHeader" placeholder="ابحث عن أنميك المفضل...">
        <i class="fas fa-search search-icon"></i>
    </div>
    
    <div class="user-info" id="userInfo">
      <img id="headerProfile" src="https://i.ibb.co/YRShYmn/avatar.png" alt="صورة المستخدم">
      <span class="user-name" id="headerName">زائر</span>
      <i id="headerVerify" class="fa-solid fa-crown verify-gold" title="توثيق ذهبي" style="display:none;"></i>

      <div class="user-menu" id="userMenu">
        <a href="profile.html"><i class="fa-solid fa-user-circle"></i> الملف الشخصي</a>
        <a href="favorites.html"><i class="fa-solid fa-bookmark"></i> المفضلة</a>
        <a href="settings.html"><i class="fa-solid fa-sliders-h"></i> الإعدادات</a>
        <a href="#" id="logoutBtn"><i class="fa-solid fa-power-off"></i> تسجيل الخروج</a>
      </div>
    </div>
  </header>

  <div class="news-ticker">
    <div class="ticker-content">
      <span>✨ ترقبوا الموسم الجديد من أنمي Demon Slayer: Hashira Training Arc</span>
      <span>🎉 أعلن عن أنمي Spy × Family الجزء الثاني قريبًا</span>
      <span>🔥 One Piece يحطم الأرقام القياسية مع الحلقة 1079</span>
      <span>🌟 تصويت لأفضل أنمي 2024 مفتوح الآن</span>
      <span>🎬 أنمي جديد Blue Lock: Episode Nagi قادم في 2025</span>
    </div>
  </div>

  <section class="search-bar search-bar-standalone">
    <input type="text" id="search" placeholder="ابحث عن أنميك المفضل...">
    <i class="fas fa-search search-icon"></i>
  </section>

  <div class="loading" id="loading">
    <div class="loading-spinner"></div>
    <p>جاري تحميل الأنميات...</p>
  </div>

  <main id="animeGrid" class="grid">
    </main>

  <div id="oraaSidebar" class="sidebar">
    <div class="sidebar-header">
        <h2><i class="fa-solid fa-stars"></i> الإعدادات المميزة</h2>
        <i class="fa-solid fa-xmark close-btn" id="closeSidebar"></i>
    </div>
    
    <div class="sidebar-content">
        <div class="sidebar-section">
            <div class="sidebar-section-title">
                <i class="fa-solid fa-play-circle"></i>
                تجربة المشاهدة
            </div>
            
            <div class="sidebar-item">
                <span>
                    <i class="fa-solid fa-moon-stars"></i>
                    <div>
                        الوضع الليلي المميز
                        <div class="item-description">تخفيف إضافي للسطوع مع ألوان مريحة</div>
                    </div>
                </span>
                <label class="switch">
                    <input type="checkbox" id="premiumDarkToggle">
                    <span class="slider"></span>
                </label>
            </div>
            
            <div class="sidebar-item">
                <span>
                    <i class="fa-solid fa-bolt-lightning"></i>
                    <div>
                        مُسرع البث الذكي
                        <div class="item-description">تحميل أذكى وأسرع للحلقات</div>
                    </div>
                </span>
                <label class="switch">
                    <input type="checkbox" id="smartStreamToggle" checked>
                    <span class="slider"></span>
                </label>
            </div>
            
            <div class="sidebar-item">
                <span>
                    <i class="fa-solid fa-download"></i>
                    <div>
                        التحميل التلقائي
                        <div class="item-description">تحميل الحلقات الجديدة تلقائياً</div>
                    </div>
                </span>
                <label class="switch">
                    <input type="checkbox" id="autoDownloadToggle">
                    <span class="slider"></span>
                </label>
            </div>
        </div>

        <div class="sidebar-section">
            <div class="sidebar-section-title">
                <i class="fa-solid fa-highlighter"></i>
                الجودة والإشعارات
            </div>
            
            <div class="sidebar-item">
                <span>
                    <i class="fa-solid fa-hd"></i>
                    <div>
                        الجودة التلقائية
                        <div class="item-description">تعديل الجودة تلقائياً حسب سرعة الانترنت</div>
                    </div>
                </span>
                <label class="switch">
                    <input type="checkbox" id="autoQualityToggle" checked>
                    <span class="slider"></span>
                </label>
            </div>
            
            <div class="sidebar-item">
                <span>
                    <i class="fa-solid fa-bell"></i>
                    <div>
                        إشعارات الحلقات الجديدة
                        <div class="item-description">إشعار فوري عند نزول حلقات جديدة</div>
                    </div>
                </span>
                <label class="switch">
                    <input type="checkbox" id="episodeNotificationsToggle" checked>
                    <span class="slider"></span>
                </label>
            </div>
            
            <div class="sidebar-item">
                <span>
                    <i class="fa-solid fa-wifi"></i>
                    <div>
                        وضع توفير البيانات
                        <div class="item-description">تقليل جودة الفيديو عند استخدام البيانات</div>
                    </div>
                </span>
                <label class="switch">
                    <input type="checkbox" id="dataSaverToggle">
                    <span class="slider"></span>
                </label>
            </div>
        </div>

        <div class="sidebar-section">
            <div class="sidebar-section-title">
                <i class="fa-solid fa-rocket"></i>
                الميزات المتقدمة
            </div>
            
            <div class="sidebar-item">
                <span>
                    <i class="fa-solid fa-eye-slash"></i>
                    <div>
                        إخفاء المكتملة
                        <div class="item-description">إخفاء الأنميات التي انتهيت من مشاهدتها</div>
                    </div>
                </span>
                <label class="switch">
                    <input type="checkbox" id="hideCompletedToggle" checked>
                    <span class="slider"></span>
                </label>
            </div>
            
            <div class="sidebar-item">
                <span>
                    <i class="fa-solid fa-clock-rotate-left"></i>
                    <div>
                        متابعة التقدم التلقائي
                        <div class="item-description">حفظ تقدمك تلقائياً في جميع الأجهزة</div>
                    </div>
                </span>
                <label class="switch">
                    <input type="checkbox" id="autoProgressToggle" checked>
                    <span class="slider"></span>
                </label>
            </div>
            
            <div class="sidebar-item">
                <span>
                    <i class="fa-solid fa-closed-captioning"></i>
                    <div>
                        الترجمات الذكية
                        <div class="item-description">تحسين تلقائي للترجمات العربية</div>
                    </div>
                </span>
                <label class="switch">
                    <input type="checkbox" id="smartSubsToggle">
                    <span class="slider"></span>
                </label>
            </div>
        </div>

        <div class="sidebar-section">
            <div class="sidebar-section-title">
                <i class="fa-solid fa-user-gear"></i>
                الحساب والإعدادات
            </div>
            
            <a href="settings.html" class="sidebar-item">
                <span>
                    <i class="fa-solid fa-gears"></i>
                    الإعدادات العامة
                </span>
                <i class="fa-solid fa-chevron-left"></i>
            </a>
            
            <a href="profile.html" class="sidebar-item">
                <span>
                    <i class="fa-solid fa-user-shield"></i>
                    إدارة الحساب
                </span>
                <i class="fa-solid fa-chevron-left"></i>
            </a>
            
            <a href="faq.html" class="sidebar-item">
                <span>
                    <i class="fa-solid fa-circle-question"></i>
                    الأسئلة الشائعة
                </span>
                <i class="fa-solid fa-chevron-left"></i>
            </a>
            
            <a href="about.html" class="sidebar-item">
                <span>
                    <i class="fa-solid fa-circle-info"></i>
                    حول التطبيق
                </span>
                <i class="fa-solid fa-chevron-left"></i>
            </a>
        </div>
    </div>
  </div>

  <footer>
    <a href="index.html" class="nav-item active">
      <div class="nav-icon">
        <i class="fa-solid fa-house-chimney"></i>
      </div>
      <span class="nav-label">الرئيسية</span>
    </a>
    
    <a href="searching.html" class="nav-item">
      <div class="nav-icon">
        <i class="fa-solid fa-compass"></i>
      </div>
      <span class="nav-label">اكتشاف</span>
      <span class="nav-badge">جديد</span>
    </a>
    
    <a href="favorites.html" class="nav-item">
      <div class="nav-icon">
        <i class="fa-solid fa-heart"></i>
      </div>
      <span class="nav-label">المفضلة</span>
      <span class="nav-badge" id="favoritesCount">5</span>
    </a>
    
    <a href="chat.html" class="nav-item">
      <div class="nav-icon">
        <i class="fa-solid fa-comments"></i>
      </div>
      <span class="nav-label">المجتمع</span>
    </a>
    
    <a href="profile.html" class="nav-item">
      <div class="nav-icon">
        <i class="fa-solid fa-user"></i>
      </div>
      <span class="nav-label">حسابي</span>
    </a>
  </footer>

  <button class="to-home-btn pulse" onclick="window.location.href='index.html'">
    <i class="fa-solid fa-house"></i>
  </button>

  <div class="toast" id="toast"></div>

  <script>
    // قاعدة بيانات الأنميات المحسنة
    const ANIME_DATABASE = [
      { title: "قاتل الشياطين: تدريب الهاشيرا", year: "2025", img: "https://cdn.myanimelist.net/images/anime/1015/138510.jpg", desc: "تدريب الهاشيرا الجديد", episodes: 12, rating: 4.9 },
      { title: "أكاديمية الأبطال 7", year: "2025", img: "https://cdn.myanimelist.net/images/anime/1764/132658.jpg", desc: "الموسم السابع من أكاديمية الأبطال", episodes: 25, rating: 4.7 },
      { title: "بلو لوك: حلقة ناغي", year: "2025", img: "https://cdn.myanimelist.net/images/anime/1286/138033.jpg", desc: "أنمي بلو لوك الجديد", episodes: 12, rating: 4.8 },
      { title: "ون بيس: القوس الجديد", year: "2025", img: "https://cdn.myanimelist.net/images/anime/1244/138135.jpg", desc: "استمرار مغامرات لوفي", episodes: 24, rating: 4.9 },
      { title: "أتاك على تايتان: النهاية الحقيقية", year: "2025", img: "https://cdn.myanimelist.net/images/anime/1429/138456.jpg", desc: "نهاية السلسلة الأسطورية", episodes: 6, rating: 5.0 },
      { title: "سولو ليفلينج", year: "2024", img: "https://cdn.myanimelist.net/images/anime/1935/140439.jpg", desc: "أنمي الصعود المنفرد", episodes: 12, rating: 4.8 },
      { title: "فرييرن: ما بعد الرحلة", year: "2024", img: "https://cdn.myanimelist.net/images/anime/1764/132807.jpg", desc: "أنمي فرييرن الساحرة", episodes: 24, rating: 4.9 },
      { title: "مذكرات الصيدلية", year: "2024", img: "https://cdn.myanimelist.net/images/anime/1958/140439.jpg", desc: "أنمي مذكرات الصيدلية", episodes: 12, rating: 4.7 },
      { title: "ماشل: السحر والعضلات 2", year: "2024", img: "https://cdn.myanimelist.net/images/anime/1015/138510.jpg", desc: "الموسم الثاني من ماشل", episodes: 12, rating: 4.6 },
      { title: "سباي × فاميلي 2", year: "2024", img: "https://cdn.myanimelist.net/images/anime/1444/138033.jpg", desc: "الموسم الثاني من سباي فاميلي", episodes: 25, rating: 4.9 },
      { title: "بطل الدرع 3", year: "2024", img: "https://cdn.myanimelist.net/images/anime/1595/138033.jpg", desc: "الموسم الثالث من بطل الدرع", episodes: 12, rating: 4.5 },
      { title: "ناروتو: الجيل الجديد", year: "2024", img: "https://cdn.myanimelist.net/images/anime/1334/138456.jpg", desc: "أبناء الأبطال الأصليين", episodes: 24, rating: 4.7 },
    ];

    // دالة لعرض الإشعارات
    function showToast(message, type = 'info') {
      const toast = document.getElementById('toast');
      toast.textContent = message;
      toast.className = 'toast';
      toast.classList.add(type);
      
      setTimeout(() => {
        toast.classList.add('show');
      }, 10);
      
      setTimeout(() => {
        toast.classList.remove('show');
      }, 4000);
    }

    // دالة لاختيار الأنمي
    function selectAnime(animeData) {
      localStorage.setItem("selectedAnime", JSON.stringify(animeData));
      window.location.href = "anime.html";
    }

    // دالة تحميل الأنميات
    function loadAnimes() {
      const loading = document.getElementById('loading');
      const animeGrid = document.getElementById('animeGrid');
      
      loading.style.display = 'block';
      animeGrid.innerHTML = '';

      setTimeout(() => {
        ANIME_DATABASE.forEach(anime => {
          const animeCard = document.createElement('div');
          animeCard.className = 'anime-card';
          animeCard.setAttribute('data-year', anime.year);
          
          animeCard.innerHTML = `
            <span class="anime-year">${anime.year}</span>
            <div class="anime-rating">
              <i class="fas fa-star"></i>
              ${anime.rating}
            </div>
            <img src="${anime.img}" alt="${anime.title}" loading="lazy" 
                 onerror="this.src='https://placehold.co/150x200/1A1A3A/8B7BFF?text=${encodeURIComponent(anime.title)}'">
            <p>${anime.title}</p>
          `;
          
          animeCard.addEventListener('click', () => selectAnime(anime));
          animeGrid.appendChild(animeCard);
        });
        
        loading.style.display = 'none';
        showToast(`✅ تم تحميل ${ANIME_DATABASE.length} أنمي بنجاح`, 'success');
        
        // إضافة تأثيرات الظهور للأنميات
        addScrollAnimations();
      }, 1000);
    }

    // دالة لإضافة تأثيرات التمرير
    function addScrollAnimations() {
      const animeCards = document.querySelectorAll('.anime-card');
      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.style.opacity = '1';
            entry.target.style.transform = 'translateY(0)';
          }
        });
      }, {
        threshold: 0.1,
        rootMargin: '0px 0px -50px 0px'
      });

      animeCards.forEach(card => {
        card.style.opacity = '0';
        card.style.transform = 'translateY(30px)';
        card.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
        observer.observe(card);
      });
    }

    document.addEventListener("DOMContentLoaded", () => {
      // عناصر القائمة المنسدلة للمستخدم
      const userInfo = document.getElementById("userInfo");
      const userMenu = document.getElementById("userMenu");
      const headerName = document.getElementById("headerName");
      const headerProfile = document.getElementById("headerProfile");
      const headerVerify = document.getElementById("headerVerify");
      const logoutBtn = document.getElementById("logoutBtn");
      
      // عناصر القائمة الجانبية (Sidebar)
      const sidebar = document.getElementById("oraaSidebar");
      const settingsToggle = document.getElementById("settingsToggle");
      const closeSidebar = document.getElementById("closeSidebar");
      
      // عناصر البحث والتصفية (تم التعديل ليناسب شريطي بحث)
      const searchInputStandalone = document.getElementById("search");
      const searchInputHeader = document.getElementById("searchHeader");
      const animeGrid = document.getElementById("animeGrid");
      
      // عناصر الميزات المميزة الجديدة
      const premiumDarkToggle = document.getElementById("premiumDarkToggle");
      const smartStreamToggle = document.getElementById("smartStreamToggle");
      const autoDownloadToggle = document.getElementById("autoDownloadToggle");
      const autoQualityToggle = document.getElementById("autoQualityToggle");
      const episodeNotificationsToggle = document.getElementById("episodeNotificationsToggle");
      const dataSaverToggle = document.getElementById("dataSaverToggle");
      const hideCompletedToggle = document.getElementById("hideCompletedToggle");
      const autoProgressToggle = document.getElementById("autoProgressToggle");
      const smartSubsToggle = document.getElementById("smartSubsToggle");

      // 1. تحميل الأنميات أولاً
      loadAnimes();

      // 2. منطق تفعيل شريط البحث (معدل الآن للعمل مع كلا شريطي البحث)
      let searchTimeout;
      const filterAnimes = (inputElement) => {
          const searchTerm = inputElement.value.toLowerCase().trim();
          const animeCards = animeGrid.getElementsByClassName("anime-card");
          
          let foundCount = 0;

          Array.from(animeCards).forEach(card => {
              const titleElement = card.querySelector('p');
              
              if (titleElement) {
                  const animeTitle = titleElement.textContent.toLowerCase();
                  const matchesSearch = animeTitle.includes(searchTerm);
                  
                  card.style.display = matchesSearch ? 'block' : 'none';
                  if(matchesSearch) foundCount++;
              }
          });
          
          if(searchTerm.length > 0) {
              showToast(`🔍 تم العثور على ${foundCount} نتائج للبحث`, 'info');
          }
      };
      
      // مزامنة البحث بين شريطي البحث وإطلاق دالة الفلترة
      const handleSearchInput = (e) => {
          const currentInput = e.target;
          const otherInput = currentInput.id === 'search' ? searchInputHeader : searchInputStandalone;
          
          // مزامنة القيمة بين الشريطيّن
          if (otherInput) {
            otherInput.value = currentInput.value;
          }
          
          clearTimeout(searchTimeout);
          searchTimeout = setTimeout(() => filterAnimes(currentInput), 300);
      };

      searchInputStandalone.addEventListener("input", handleSearchInput);
      if (searchInputHeader) {
         searchInputHeader.addEventListener("input", handleSearchInput);
      }


      // 3. منطق إظهار/إخفاء القائمة الجانبية
      settingsToggle.addEventListener('click', () => {
          sidebar.classList.add('open');
      });

      closeSidebar.addEventListener('click', () => {
          sidebar.classList.remove('open');
      });

      // إغلاق القائمة الجانبية عند النقر خارجها
      window.addEventListener('click', (e) => {
          if (sidebar.classList.contains('open') && 
              !settingsToggle.contains(e.target) && 
              !sidebar.contains(e.target)) {
              sidebar.classList.remove('open');
          }
      });
      
      // 4. منطق الميزات المميزة الجديدة
      premiumDarkToggle.addEventListener('change', (e) => {
          if(e.target.checked) {
             document.body.style.backgroundColor = "#000015";
             document.body.style.backgroundImage = "none";
             showToast("🌙 تم تفعيل الوضع الليلي المميز!", "success");
          } else {
             document.body.style.backgroundColor = "#0F0F25";
             document.body.style.backgroundImage = "radial-gradient(circle at 10% 20%, rgba(139, 123, 255, 0.1) 0%, transparent 25%), radial-gradient(circle at 90% 80%, rgba(255, 123, 169, 0.1) 0%, transparent 25%)";
             showToast("☀️ تم إلغاء تفعيل الوضع الليلي المميز.", "info");
          }
          saveSettings();
      });
      
      smartStreamToggle.addEventListener('change', (e) => {
          if(e.target.checked) {
             showToast("⚡ تم تفعيل مُسرع البث الذكي!", "success");
          } else {
             showToast("🐢 تم إلغاء تفعيل مُسرع البث.", "info");
          }
          saveSettings();
      });

      autoDownloadToggle.addEventListener('change', (e) => {
          if(e.target.checked) {
             showToast("📥 تم تفعيل التحميل التلقائي للحلقات الجديدة.", "success");
          } else {
             showToast("📥 تم إلغاء التحميل التلقائي.", "info");
          }
          saveSettings();
      });

      autoQualityToggle.addEventListener('change', (e) => {
          if(e.target.checked) {
             showToast("🎬 تم تفعيل الجودة التلقائية.", "success");
          } else {
             showToast("🎬 تم إلغاء الجودة التلقائية.", "info");
          }
          saveSettings();
      });

      episodeNotificationsToggle.addEventListener('change', (e) => {
          if(e.target.checked) {
             showToast("🔔 تم تفعيل إشعارات الحلقات الجديدة.", "success");
          } else {
             showToast("🔔 تم إلغاء إشعارات الحلقات الجديدة.", "info");
          }
          saveSettings();
      });

      dataSaverToggle.addEventListener('change', (e) => {
          if(e.target.checked) {
             showToast("📶 تم تفعيل وضع توفير البيانات.", "success");
          } else {
             showToast("📶 تم إلغاء وضع توفير البيانات.", "info");
          }
          saveSettings();
      });

      hideCompletedToggle.addEventListener('change', (e) => {
          if(e.target.checked) {
             showToast("👁️ تم إخفاء الأنميات المكتملة.", "success");
          } else {
             showToast("👁️ تم إظهار جميع الأنميات.", "info");
          }
          saveSettings();
      });

      autoProgressToggle.addEventListener('change', (e) => {
          if(e.target.checked) {
             showToast("🔄 تم تفعيل متابعة التقدم التلقائي.", "success");
          } else {
             showToast("🔄 تم إلغاء متابعة التقدم التلقائي.", "info");
          }
          saveSettings();
      });

      smartSubsToggle.addEventListener('change', (e) => {
          if(e.target.checked) {
             showToast("📝 تم تفعيل الترجمات الذكية.", "success");
          } else {
             showToast("📝 تم إلغاء الترجمات الذكية.", "info");
          }
          saveSettings();
      });

      // 5. منطق إظهار/إخفاء قائمة المستخدم المنسدلة
      userInfo.addEventListener("click", (e) => {
        e.stopPropagation();
        userMenu.style.display = userMenu.style.display === "block" ? "none" : "block";
      });

      window.addEventListener("click", (e) => {
        if (userMenu.style.display === "block" && !userInfo.contains(e.target)) {
          userMenu.style.display = "none";
        }
      });
      
      // 6. تحميل بيانات المستخدم من الذاكرة المحلية
      const loadUserInfo = () => {
        const savedName = localStorage.getItem("profileName");
        const savedImage = localStorage.getItem("profileImg");
        const isOwner = localStorage.getItem("isOwner") === 'true';
        const loggedInUser = localStorage.getItem("loggedInUser");

        headerName.textContent = savedName || "زائر";
        
        if (savedImage && savedImage !== "null") {
          headerProfile.src = savedImage;
        } else {
          headerProfile.src = "https://i.ibb.co/YRShYmn/avatar.png";
        }

        if (isOwner || loggedInUser === "itwix907@gmail.com") {
          headerVerify.style.display = "inline";
        } else {
          headerVerify.style.display = "none";
        }
      };

      // 7. منطق تسجيل الخروج (تم نقله إلى Firebase Script لسهولة المزامنة)
      
      // 8. تحميل بيانات المستخدم عند فتح الصفحة
      loadUserInfo();

      // 9. حفظ الإعدادات في localStorage
      const saveSettings = () => {
        const settings = {
          premiumDark: premiumDarkToggle.checked,
          smartStream: smartStreamToggle.checked,
          autoDownload: autoDownloadToggle.checked,
          autoQuality: autoQualityToggle.checked,
          episodeNotifications: episodeNotificationsToggle.checked,
          dataSaver: dataSaverToggle.checked,
          hideCompleted: hideCompletedToggle.checked,
          autoProgress: autoProgressToggle.checked,
          smartSubs: smartSubsToggle.checked
        };
        localStorage.setItem('oraaPremiumSettings', JSON.stringify(settings));
      };

      const loadSettings = () => {
        const savedSettings = localStorage.getItem('oraaPremiumSettings');
        if (savedSettings) {
          const settings = JSON.parse(savedSettings);
          premiumDarkToggle.checked = settings.premiumDark || false;
          smartStreamToggle.checked = settings.smartStream !== false;
          autoDownloadToggle.checked = settings.autoDownload || false;
          autoQualityToggle.checked = settings.autoQuality !== false;
          episodeNotificationsToggle.checked = settings.episodeNotifications !== false;
          dataSaverToggle.checked = settings.dataSaver || false;
          hideCompletedToggle.checked = settings.hideCompleted !== false;
          autoProgressToggle.checked = settings.autoProgress !== false;
          smartSubsToggle.checked = settings.smartSubs || false;
          
          // تفعيل الوضع الليلي المميز مباشرة إذا كان محفوظاً
          if (premiumDarkToggle.checked) {
             document.body.style.backgroundColor = "#000015";
             document.body.style.backgroundImage = "none";
          }
        }
      };

      // تحميل الإعدادات المحفوظة
      loadSettings();

      // 10. تحديث عداد المفضلة
      const updateFavoritesCount = () => {
        const favorites = JSON.parse(localStorage.getItem('favorites') || '[]');
        document.getElementById('favoritesCount').textContent = favorites.length;
      };

      updateFavoritesCount();
    });

    // 11. إضافة اختصارات لوحة المفاتيح
    document.addEventListener('keydown', (e) => {
      // Ctrl+K للبحث
      if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
        e.preventDefault();
        // التركيز على شريط البحث المنفصل لأنه يظهر في معظم الحالات
        document.getElementById('search').focus(); 
      }
      
      // Escape لإغلاق القوائم
      if (e.key === 'Escape') {
        document.getElementById('userMenu').style.display = 'none';
        document.getElementById('oraaSidebar').classList.remove('open');
      }
    });
  </script>

  <script type="module">
    // استيراد الدوال الأساسية
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-analytics.js";
    import { getFirestore, collection, getDocs, addDoc, doc, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";
    import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";
    
    // إعدادات تطبيق Firebase الجديدة (من طلبك)
    const firebaseConfig = {
      apiKey: "AIzaSyBDMFcCvthKNkHUrEbgYY1Uc80KTPpS01M",
      authDomain: "oraa-slayer-anime.firebaseapp.com",
      projectId: "oraa-slayer-anime",
      storageBucket: "oraa-slayer-anime.firebasestorage.app",
      messagingSenderId: "426607460785",
      appId: "1:426607460785:web:c8d9844253c9111ad3bd90"
    };

    // تهيئة Firebase
    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);
    const db = getFirestore(app);
    const auth = getAuth(app);

    // دالة للتحقق من حالة المستخدم
    onAuthStateChanged(auth, (user) => {
      if (user) {
        console.log('المستخدم مسجل:', user.email);
        
        const headerName = document.getElementById('headerName');
        const headerProfile = document.getElementById('headerProfile');
        const headerVerify = document.getElementById('headerVerify');
        
        const userName = user.displayName || user.email.split('@')[0];
        
        if (headerName) headerName.textContent = userName;
        if (headerProfile && user.photoURL) headerProfile.src = user.photoURL;
        
        localStorage.setItem('loggedInUser', user.email);
        localStorage.setItem('profileName', userName);
        if (user.photoURL) localStorage.setItem('profileImg', user.photoURL);
        
        // التحقق من المالك
        if (user.email === "itwix907@gmail.com") {
          localStorage.setItem('isOwner', 'true');
          if (headerVerify) headerVerify.style.display = 'inline';
        } else {
          localStorage.removeItem('isOwner');
          if (headerVerify) headerVerify.style.display = 'none';
        }
      } else {
        console.log('المستخدم غير مسجل');
        localStorage.removeItem('loggedInUser');
        localStorage.removeItem('profileName');
        localStorage.removeItem('profileImg');
        localStorage.removeItem('isOwner');
      }
    });

    // دالة تسجيل الخروج باستخدام Firebase
    window.firebaseSignOut = () => {
        // تأكيد تسجيل الخروج
        if (confirm("هل تريد تسجيل الخروج؟")) {
            signOut(auth).then(() => {
                // مسح البيانات من الذاكرة المحلية
                localStorage.removeItem("loggedInUser");
                localStorage.removeItem("profileName");
                localStorage.removeItem("profileImg");
                localStorage.removeItem("isOwner");
                localStorage.removeItem("rememberUser");
                
                // إظهار إشعار والتحويل
                if (typeof showToast === 'function') {
                   showToast("✅ تم تسجيل الخروج بنجاح", "success");
                }
                
                setTimeout(() => {
                   window.location.href = "login.html";
                }, 1500);
            }).catch((error) => {
                console.error("Logout Error:", error);
                if (typeof showToast === 'function') {
                    showToast("❌ فشل تسجيل الخروج: " + error.message, "error");
                }
            });
        }
    };
    
    // ربط زر تسجيل الخروج
    document.getElementById("logoutBtn").addEventListener("click", (e) => {
        e.preventDefault();
        window.firebaseSignOut();
    });

    // جعل الدوال متاحة عالمياً
    window.firebaseAuth = auth;
    window.firebaseDb = db;
    
    console.log('Firebase initialized successfully with new config');
  </script><script src="main.js"></script>
  </body>
</html>

